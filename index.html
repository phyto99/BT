<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unified Brain Training</title>
    
    <!-- Unified Brain Training System -->
    <link rel="stylesheet" href="shared/unified-styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.7.7/dat.gui.min.js"></script>
    <script src="shared/unified-core.js"></script>
    
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background: #202020;
            color: #eee;
        }
        
        #game-container {
            width: 100%;
            height: 100vh;
            overflow: hidden;
        }
        
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            font-size: 24px;
            color: #eee;
        }

        /* Right side buttons matching sidebar button style */
        .unified-right-buttons {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 1000;
            display: flex;
            gap: 8px;
        }

        .unified-info-btn, .unified-stats-btn {
            width: 40px;
            height: 40px;
            background: rgba(40, 40, 40, 0.8);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            color: #eee;
            transition: background-color 0.2s;
        }

        .unified-info-btn:hover, .unified-stats-btn:hover {
            background-color: rgba(60, 60, 60, 0.9);
        }
    </style>
</head>
<body>
    <!-- Right side buttons -->
    <div class="unified-right-buttons">
        <button class="unified-info-btn" id="unified-info-btn" title="Information">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <path d="M12 16v-4"/>
                <path d="M12 8h.01"/>
            </svg>
        </button>
        <button class="unified-stats-btn" id="unified-stats-btn" title="Statistics">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M3 3v18h18"/>
                <path d="m19 9-5 5-4-4-3 3"/>
            </svg>
        </button>
    </div>

    <div id="game-container">
        <div class="loading">Loading Brain Training...</div>
    </div>
    
    <script>
        // Initialize exactly like the test version
        document.addEventListener('DOMContentLoaded', () => {
            // Create the unified system instance
            window.unifiedBrainTraining = new UnifiedBrainTraining();
            
            // Info button handler
            document.getElementById('unified-info-btn').addEventListener('click', () => {
                showInfoPopup();
            });
            
            // Stats button handler  
            document.getElementById('unified-stats-btn').addEventListener('click', () => {
                showStatsPopup();
            });
            
            // Load default game
            window.unifiedBrainTraining.loadGame('jiggle-factorial');
        });

        function showInfoPopup() {
            const popup = document.createElement('div');
            popup.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(40, 40, 40, 0.95);
                border: 1px solid #555;
                border-radius: 8px;
                padding: 20px;
                max-width: 400px;
                z-index: 2000;
                color: #eee;
                font-family: Arial, sans-serif;
            `;
            
            popup.innerHTML = `
                <h3 style="margin-top: 0; color: #fff;">Unified Brain Training</h3>
                <p>Switch between different cognitive training games using the settings panel.</p>
                <p><strong>Available Games:</strong></p>
                <ul>
                    <li>Jiggle Factorial 3D</li>
                    <li>3D Hyper N-back</li>
                    <li>Dichotic Dual N-back</li>
                    <li>Quad Box</li>
                </ul>
                <p><strong>Features:</strong></p>
                <ul>
                    <li>Fast game switching with blob URL system</li>
                    <li>Unified settings panel</li>
                    <li>Session tracking</li>
                </ul>
                <button onclick="this.parentElement.remove()" style="
                    background: #555;
                    border: none;
                    color: #eee;
                    padding: 8px 16px;
                    border-radius: 4px;
                    cursor: pointer;
                    margin-top: 10px;
                ">Close</button>
            `;
            
            document.body.appendChild(popup);
            
            // Close on outside click
            setTimeout(() => {
                document.addEventListener('click', function closePopup(e) {
                    if (!popup.contains(e.target)) {
                        popup.remove();
                        document.removeEventListener('click', closePopup);
                    }
                });
            }, 100);
        }

        function showStatsPopup() {
            const currentGame = window.unifiedBrainTraining?.currentGameId || 'none';
            const gameNames = {
                'jiggle-factorial': 'Jiggle Factorial 3D',
                '3d-hyper-nback': '3D Hyper N-back',
                'dichotic-dual-nback': 'Dichotic Dual N-back',
                'quad-box': 'Quad Box'
            };
            
            const popup = document.createElement('div');
            popup.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(40, 40, 40, 0.95);
                border: 1px solid #555;
                border-radius: 8px;
                padding: 20px;
                max-width: 400px;
                z-index: 2000;
                color: #eee;
                font-family: Arial, sans-serif;
            `;
            
            popup.innerHTML = `
                <h3 style="margin-top: 0; color: #fff;">Training Statistics</h3>
                <p><strong>Current Game:</strong> ${gameNames[currentGame] || 'None'}</p>
                <p><strong>Session Info:</strong></p>
                <ul>
                    <li>Games available: 4</li>
                    <li>System: Blob URL loading</li>
                    <li>Status: Active</li>
                </ul>
                <p style="font-size: 12px; color: #aaa; margin-top: 15px;">
                    Detailed statistics and progress tracking coming soon!
                </p>
                <button onclick="this.parentElement.remove()" style="
                    background: #555;
                    border: none;
                    color: #eee;
                    padding: 8px 16px;
                    border-radius: 4px;
                    cursor: pointer;
                    margin-top: 10px;
                ">Close</button>
            `;
            
            document.body.appendChild(popup);
            
            // Close on outside click
            setTimeout(() => {
                document.addEventListener('click', function closePopup(e) {
                    if (!popup.contains(e.target)) {
                        popup.remove();
                        document.removeEventListener('click', closePopup);
                    }
                });
            }, 100);
        }
    </script>
</body>
</html>